/*
 * @author: mwenbao@gmail.com
 * @license: see LICENSE.txt
 * @depend: jquery 1.10+
 * @issues: Chrome39 behaves weird when showing/hiding fixed sidebar toc list.
 *          Search `@TODO check Chrome39+' for detailed comments on this problem.
 *
 */
(function(){var c=document.getElementsByTagName("script");var b=c[c.length-1];var a=b.src;window.gThemePath=a.substr(0,a.lastIndexOf("/js/"))})();window.gEnableTocStatusUpdate=true;window.gEnableTocListAutoScroll=true;window.gMouseInSidebarTocList=false;window.gToolbarHidden=true;window.gToolbarAnimationEnabled=true;window.gFixedHeaderHeight=32;window.gFixedTocListOffsetTop=111;window.gFootnotePopoverMaxWidth=300;window.gAutoScrollDuration=400;window.gActiveTocClass="niu2-active-toc";window.gCurrHighlightedElem=null;window.gCurrHighlightedBackref=null;window.gCurrTocId="";window.gSidebarCtrlButtonEnabled=true;window.gMousePositionX=0;window.gMousePositionY=0;$(document).ready(function(){initGoogleCSEAnimation()});function onContentLoaded(){initPygments();initHermitPlayer();initLazyLoad();initFootnote();initHeaderAnchors();$(window).scroll(function(){toggleSidebarTocFixed();locateTocInViewport()});updateFootnoteStatus();getTocList().detach();initTocListIndex(getTocList());getTocList().appendTo(getSidebarToc());setSidebarTocWidth();setTocOverflowedTitle();initTocLinkScrollAnimation();initAllTocsCtrl();locateTocInViewport();initToolbar()}function initPygments(){if($("pre")[0]){appendCssFileToHead("/css/pygments.min/"+$("#niu2-pygments").data("theme")+".min.css")}}function initHermitPlayer(){if($(".hermit")[0]){appendCssFileToHead("/hermit/assets/style/hermit.min.css");window.hermit={url:window.gThemePath+"/soundmanager2/swf"};appendJsFileToBody("/soundmanager2/script/soundmanager2.min.js");appendJsFileToBody("/hermit/assets/script/hermit.min.js")}}function initToolbar(){if(getToolbar()){window.gToolbarLeftPos=$(getToolbar()).css("left");var h=$(".niu2-right-container");var a=$("#niu2-toolbar-showsidebar").data("title");var g=$("#niu2-toolbar-ctrlsidebar").attr("title");var m=window.location.pathname.replace(/html$/,"md");if(-1==m.replace(/^\//,"").search("/")){m="/pages"+m}var c=$("#niu2-toolbar-github").data("repo").replace(/\/+$/g,"");var k=$("#niu2-toolbar-bitbucket").data("repo").replace(/\/+$/g,"");if(""!=c){$("#niu2-toolbar-revhistory").attr("href","https://github.com/"+c+"/commits/master/content"+m);$("#niu2-toolbar-viewsource").attr("href","https://raw.githubusercontent.com/"+c+"/master/content"+m)}else{if(""!=k){$("#niu2-toolbar-revhistory").attr("href","https://bitbucket.org/"+k+"/history-node/master/content"+m);$("#niu2-toolbar-viewsource").attr("href","https://bitbucket.org/"+k+"/raw/master/content"+m)}}var e=$("#niu2-toolbar-load").data("loading-icon");$('<div id="niu2-loading-overly" style="display:none;"><i id="niu2-loading-icon" class="'+e+'"></i></div>').appendTo("body");var f=$("#niu2-left-container");var j=$("#body-footer");var i=$("#niu2-toolbar-ctrlsidebar i");var b=$("#niu2-toolbar-ctrlsidebar");var d=300;var l=$("#niu2-loading-overly");window.gSidebarCtrlButtonColor=$("#niu2-toolbar-ctrlsidebar").css("color");$("#niu2-toolbar-ctrlsidebar").click(function(n){n.preventDefault();if(!window.gSidebarCtrlButtonEnabled){return}l.show();disableSidebarCtrlButton();if(!h.is(":hidden")){markVerticalPosition();h.fadeOut("fast");f.removeClass("with-right-border");f.animate({width:"67%"},d,complete=function(){restoreVerticalPosition(function(){enableSidebarCtrlButton();i.attr("class","icon-3x icon-show-sidebar");b.attr("title",a);l.hide();resetFootnoteCache()})});j.animate({width:"67%"},d)}else{markVerticalPosition();f.animate({width:"50%"},d,complete=function(){var o=$(".niu2-right-container");var p=o.parent();o.detach();f.addClass("with-right-border");window.gEnableTocStatusUpdate=false;h.fadeIn("fast",complete=function(){o.appendTo(p);toggleSidebarTocFixed()});restoreVerticalPosition(function(){enableSidebarCtrlButton();i.attr("class","icon-3x icon-hide-sidebar");b.attr("title",g);window.gEnableTocStatusUpdate=true;locateTocInViewport();l.hide();resetFootnoteCache()})});j.animate({width:"50%"},d)}})}}function initLazyLoad(){var e=$("#niu2-main-content img.lazy");var b=$("#niu2-lazy-load");if(0!=e.length&&b.length!=0){appendJsFileToBody("/js/jquery.lazyload.min.js");appendCssFileToHead("/colorbox/colorbox.min.css");appendJsFileToBody("/colorbox/jquery.colorbox.min.js");var d=getMainContent().getBoundingClientRect().width;var c=b.data("loading-txt");var a=b.data("loading-icon");e.each(function(g,j){var k=parseInt($(j).data("width"));var f=parseInt($(j).data("height"));var l=(k>d)?(d/k*f):f;l=l.toFixed();$(j).attr("height",l+"px");$(j).parent().addClass("image-cover-box");var h=$('<span class="image-cover">'+c+'<i class="'+a+'"></i></span>').insertAfter($(j));h.css("top",((l-h.height())/2-3)+"px");h.css("width",(d>k?k:d)+"px")});e.lazyload({threshold:0,effect:"fadeIn",load:function(){var g=$(this);var f=g.next(".image-cover");var h=g.parent();h.css("height",g.css("height"));g.detach();g.css("height","auto");g.attr("height","");h.removeClass("image-cover-box");f.hide();var i=$('<a href="'+g.attr("src")+' " title="'+g.attr("alt")+'"></a>');g.appendTo(i);i.colorbox({href:g.attr("src"),returnFocus:false,scalePhotos:true,maxWidth:"95%",maxHeight:"100%",});i.appendTo(h);h.css("height","auto")}})}}function appendCssFileToHead(a){$('<link rel="stylesheet" href="'+window.gThemePath+a+'" type="text/css"/>').appendTo($("head"))}function appendJsFileToBody(a){$('<script src="'+window.gThemePath+a+'" type="text/javascript"><\/script>').appendTo($("body"))}function initHeaderAnchors(){getMainContentHeaders().each(function(a,b){$('<a class="niu2-header-anchor" href="#'+$(b).attr("id")+'">¶</a>').appendTo($(b))});initHeaderScrollAnimation(getMainContentHeaders().children(".niu2-header-anchor"))}function getMainContentHeaders(){if(window.gMainContentHeaders==undefined){window.gMainContentHeaders=$("#niu2-main-content").find(":header")}return window.gMainContentHeaders}function setSidebarTocWidth(){var a=getSidebarToc().width();getSidebarToc().attr("style","max-width:"+a+"px")}function resetSidebarToc(){var a=$("#niu2-sidebar-toc")}function toggleSidebarTocFixed(){var b=$("#niu2-sidebar-toc");var a=$("#niu2-sidebar-meta");if(b.length==0||a.length==0){return}var c=$(window).scrollTop();var e=a.offset().top+a.height()-55;if(!b.is(":hidden")&&c>e&&"niu2-sidebar"==b.attr("class")){var d=b.parent();b.detach();b.attr("class","niu2-sidebar niu2-sidebar-toc-fixed");b.appendTo(d)}else{if(c<=e&&"niu2-sidebar"!=b.attr("class")){b.attr("class","niu2-sidebar")}}}function showCSE(){if(!$("#niu2-cse-search-input").is(":visible")){$("#niu2-cse-search-input").val("");$("#niu2-cse-search-input").show(300,function(){$("#niu2-cse-search-input").focus()});$("#niu2-cse-search-image").hide(300)}}function hideCSE(){if($("#niu2-cse-search-input").is(":visible")){$("#niu2-cse-search-input").hide(300);$("#niu2-cse-search-image").show(300)}}function disableSidebarCtrlButton(){window.gSidebarCtrlButtonEnabled=false;$("#niu2-toolbar-ctrlsidebar").attr("style","color: "+window.gSidebarCtrlButtonColor)}function enableSidebarCtrlButton(){window.gSidebarCtrlButtonEnabled=true;$("#niu2-toolbar-ctrlsidebar").attr("style","")}function markVerticalPosition(){window.gCurrElemInViewport=null;var c=$("#"+window.gCurrTocId);if(c[0].getBoundingClientRect().top==0){window.gCurrElemInViewport=c;window.gCurrElemTopInViewport=0;return}var b;if(window.gCurrTocId=="content-heading"){b=$("#niu2-main-content").children()}else{if(window.gCurrTocId=="content-comments"){var d=$("#ds-reset");if(d.length==0){return}b=d.children().first().nextUntil(".ds-comments").andSelf().add(".ds-comments")}else{b=c.nextAll()}}var a=b.length;b.each(function(h,j){var g=$(j);var f=j.getBoundingClientRect().top;if(f>0){window.gCurrElemInViewport=g.prev();if(window.gCurrElemInViewport.length==0){window.gCurrElemInViewport=null;return false}window.gCurrElemHeightInViewport=window.gCurrElemInViewport.height();window.gCurrElemTopInViewport=window.gCurrElemInViewport[0].getBoundingClientRect().top;return false}if(h+1==a){window.gCurrElemInViewport=g;window.gCurrElemHeightInViewport=window.gCurrElemInViewport.height();window.gCurrElemTopInViewport=window.gCurrElemInViewport[0].getBoundingClientRect().top}})}function restoreVerticalPosition(a){if(window.gCurrElemInViewport==null){a();return}var c=0;if(window.gCurrElemTopInViewport!=0){var b=window.gCurrElemInViewport.height();c=b/window.gCurrElemHeightInViewport*-1*window.gCurrElemTopInViewport}currElemScrollTop=c+window.gCurrElemInViewport.offset().top;window.gEnableTocListAutoScroll=false;$("body, html").animate({scrollTop:currElemScrollTop},window.gAutoScrollDuration,function(){window.gEnableTocListAutoScroll=true;a()})}function setTocOverflowedTitle(){getSidebarTocLinks().each(function(a,b){$(b).mouseenter(function(){var c=$(this);if(isOverflowed(this)&&!c.attr("title")){c.attr("title",c.text())}})})}function isOverflowed(a){if(a.scrollHeight>a.offsetHeight||a.scrollWidth>a.offsetWidth){return true}return false}function toggleTopIcon(){$(this).children(":first").toggleClass("niu2-top-icon-hidden")}function initGoogleCSEAnimation(){$("#niu2-cse-ctrl-box").click(showCSE);$("#niu2-cse-ctrl-box").focus(showCSE);$("#niu2-cse-search-input").hide();$("#niu2-cse-search-input").focusout(hideCSE);$(document).keyup(function(a){a=a||window.event;if(a.keyCode==27){hideCSE()}})}function getToolbar(){if(!window.gToolbar){window.gToolbar=$("#niu2-toolbar")[0]}return window.gToolbar}function getMainContent(){if(!window.gMainContent){window.gMainContent=$("#niu2-main-content")[0]}return window.gMainContent}function getHtmlHeaders(){if(!window.gHtmlHeaders){window.gHtmlHeaders=$(":header");if(getFootnoteRefs().length>0){window.gHtmlHeaders.push($("#content-references")[0])}var a=$("#content-comments")[0];if(a){window.gHtmlHeaders.push(a)}}return window.gHtmlHeaders}function locateTocInViewport(){if(!window.gEnableTocStatusUpdate){return}var a=getHtmlHeaders();var d;for(var b=0;b<a.length;b++){var c=a[b];if(c.getBoundingClientRect().top>=window.gFixedHeaderHeight){if(b>0){c=a[b-1]}d=c.id;break}}if(!d){d=a.last().attr("id")}window.gCurrTocId=d;resetTocListHeight();updateTocLinkStatus(d);autoscrollTocList()}function getSidebarTocLinks(){if(!window.gSidebarTocLinks){window.gSidebarTocLinks=$("#niu2-sidebar-toc-list a")}return window.gSidebarTocLinks}function getSidebarToc(){if(!window.gSidebarToc){window.gSidebarToc=$("#niu2-sidebar-toc")}return window.gSidebarToc}function getTocList(){if(!window.gTocList){window.gTocList=$("#niu2-sidebar-toc-list");window.gTocListType=window.gTocList[0].tagName.toLowerCase()}return window.gTocList}function initTocListIndex(b,a){if(a&&""!=a){a+="."}else{a=""}b.children().each(function(g,h){var c=$(h);var d=a+(g+1);c.prepend('<span class="niu2-sidebar-toc-index">'+d+".</span>");var f=c.children();if(2<f.length){initTocListIndex($(f[2]),d)}})}function unhighlightActiveToc(){var a=$("."+window.gActiveTocClass).first();if(a.length!=0){a.attr("class","")}}function updateTocLinkStatus(a){if(isAllTocsClosed()){closeAllTocs()}getSidebarTocLinks().each(function(b,d){var c=$(d);if(a==c.attr("href").substr(c.attr("href").indexOf("#")+1)){c.attr("class",window.gActiveTocClass);if(isAllTocsClosed()){openActiveTocList(c.parent())}}else{if(""!=c.attr("class")){c.attr("class","")}}})}function resetTocListHeight(){var a=$(window).height()-window.gFixedTocListOffsetTop+20;if(getTocList().height()>=a){getTocList().attr("style","height: "+a+"px;")}else{getTocList().attr("style","")}}function autoscrollTocList(){if(!window.gEnableTocListAutoScroll||window.gMouseInSidebarTocList){return}var d=$("."+window.gActiveTocClass).first();if(d.length==0){return}var e=d[0].getBoundingClientRect();var b=getTocList()[0].getBoundingClientRect();var c=e.top-(b.top+b.bottom)/2;var a=(c>0)?1:-1;c+=a*b.height/5;if(e.top<b.top+15||e.bottom>b.bottom-15){window.gEnableTocListAutoScroll=false;getTocList().animate({scrollTop:getTocList().scrollTop()+c},window.gAutoScrollDuration,function(){window.gEnableTocListAutoScroll=true})}}function openActiveTocList(b){var c=b.children();var a=$(c[2]);if(c.length>2&&(a.is("ol")||a.is("ul"))){showToc(a);showToc(a.children())}showToc(b);showToc(b.siblings());b.parents().each(function(d,e){if("niu2-sidebar-toc-list"==e.id){return false}showToc($(e));if($(e).is("li")){showToc($(e).siblings())}})}function closeAllTocs(){hideToc($("#niu2-sidebar-toc-list "+window.gTocListType+" li"));hideToc($("#niu2-sidebar-toc-list li "+window.gTocListType))}function openAllTocs(){showToc($("#niu2-sidebar-toc-list "+window.gTocListType+" li"));showToc($("#niu2-sidebar-toc-list li "+window.gTocListType))}function initHeaderScrollAnimation(a){initScrollAnimation(a,function(b){return b.offset().top},window.gAutoScrollDuration,function(){updateFootnoteStatus();window.gEnableTocStatusUpdate=true;locateTocInViewport()})}function initTocLinkScrollAnimation(){initHeaderScrollAnimation(getSidebarTocLinks())}function initFootnote(){if(getFootnoteRefs().length>0){var a="脚注";getTocList().children(":last").before('<li><a href="#content-references">'+a+"</a></li>");$(".footnote").before('<h2 id="content-references">'+a+"</h2>")}initFootnoteBackRefLinks();initFootnoteBackRefAnimation();initMouseXYRecord();initFootnoteRefPopover();initFootnoteRefAnimation()}function updateFootnoteStatus(){unhighlightFootnote();highlightFootnote()}function unhighlightCurrHighlighted(){if(window.gCurrHighlightedElem){unhighlightElement(window.gCurrHighlightedElem)}if(window.gCurrHighlightedBackref){unhighlightSubBackref(window.gCurrHighlightedBackref)}}function highlightElement(a){a.addClass("alert-success");window.gCurrHighlightedElem=a}function unhighlightElement(a){a.removeClass("alert-success")}function highlightSubBackref(a){a.addClass("activeSubBackref");window.gCurrHighlightedBackref=a}function unhighlightSubBackref(a){a.removeClass("activeSubBackref")}function getFootnoteHlIndex(){return 1}function highlightFtSubBackrefs(a){if(null!=window.gCurrFootnoteRefPos){var b=$(a.children(".backref-span").children(".sub-backref-link").children()[window.gCurrFootnoteRefPos]);if(b[0]){highlightSubBackref(b);window.gHlFootnoteSubBackref=b}}}function highlightFootnote(){var a=window.location.hash.substring(1);if(null!=window.gCurrFootnoteHlPos){var b=$(getFootnoteRefs().parent().filter('[id="'+a+'"]'));if(b.length>window.gCurrFootnoteHlPos){window.gHlFootnoteRef=$(b[window.gCurrFootnoteHlPos]);unhighlightCurrHighlighted();highlightElement(window.gHlFootnoteRef);return}}getFootnoteList().each(function(c,f){var d=$(f);if(d.attr("id")==a){unhighlightCurrHighlighted();highlightElement($(d));highlightFtSubBackrefs(d);window.gHlFootnote=d;return false}})}function unhighlightFootnote(){if(window.gHlFootnoteRef){if("#"+window.gHlFootnoteRef.attr("id")==window.location.hash){return false}unhighlightElement(window.gHlFootnoteRef);window.gHlFootnoteRef=null;return}if(window.gHlFootnote){if("#"+window.gHlFootnote.attr("id")==window.location.hash){return false}var a=$(window.gHlFootnote);if(""!=a.attr("class")){unhighlightElement(a);window.gHlFootnote=null}}if(window.gHlFootnoteSubBackref){unhighlightSubBackref(window.gHlFootnoteSubBackref);return}}function resetFootnoteCache(){resetFootnoteRefs();resetFootnoteBackRefs();resetFootnoteRefMap()}function resetFootnoteRefs(){window.gFootnoteRefs=$(".footnote-ref")}function getFootnoteRefs(){if(!window.gFootnoteRefs){resetFootnoteRefs()}return window.gFootnoteRefs}function resetFootnoteRefMap(){window.gFootnoteIdMap={};getFootnoteRefs().each(function(c,f){var b=$(f);var d=b.parent();var a=b.attr("href").substring(1);if(!window.gFootnoteIdMap[a]){window.gFootnoteIdMap[a]={};window.gFootnoteIdMap[a].id=d.attr("id");window.gFootnoteIdMap[a].offsets=[]}window.gFootnoteIdMap[a].offsets.push(d.offset())})}function getFootnoteRefMap(a){if(!window.gFootnoteIdMap){resetFootnoteRefMap()}return window.gFootnoteIdMap[a]}function resetFootnoteBackRefs(){window.gFootnoteBackRefs=$(".footnote-backref")}function getFootnoteBackRefs(){if(!window.gFootnoteBackRefs){resetFootnoteBackRefs()}return window.gFootnoteBackRefs}function getFootnoteList(){if(!window.gFootnoteList){window.gFootnoteList=$(".footnote li")}return window.gFootnoteList}function initFootnoteBackRefLinks(){getFootnoteList().each(function(d,h){var a=$(h);var f=a.attr("id");var g=getFootnoteRefMap(a.attr("id"));var c=g.offsets.length;var b='<span class="backref-span">';if(1==(c)){b+='<a class="footnote-backref" href="#'+g.id+'" data-source="'+f+'"><i class="icon-angle-up"></i></a>'}else{b+='<i class="icon-angle-up"></i><span class="sub-backref-link">';for(var d=0;d<c;d++){b+='<a class="footnote-backref" href="#'+g.id+'" data-source="'+f+'">'+(d+1)+"</a> "}b+="</span>"}b+="</span>";a.prepend(b)})}function initFootnoteBackRefAnimation(){initScrollAnimation(getFootnoteBackRefs(),function(c,b){var a=getFootnoteRefMap(b.attr("data-source"));if(1==a.offsets.length){return a.offsets[0].top-window.gFixedHeaderHeight}else{return a.offsets[parseInt(b.text())-1].top-window.gFixedHeaderHeight}},window.gAutoScrollDuration,function(a){if(""!=a.text()){window.gCurrFootnoteHlPos=parseInt(a.text())-1}else{window.gCurrFootnoteHlPos=0}updateFootnoteStatus();window.gEnableTocStatusUpdate=true;locateTocInViewport()})}function initFootnoteRefAnimation(){initScrollAnimation(getFootnoteRefs(),function(a){return a.offset().top-100-window.gFixedHeaderHeight},window.gAutoScrollDuration,function(b){var a=getFootnoteRefs().parent().filter('[id="'+b.parent().attr("id")+'"]');a.each(function(c,d){if(b[0]==$(d).children()[0]){window.gCurrFootnoteRefPos=c;return false}});updateFootnoteStatus();window.gEnableTocStatusUpdate=true;locateTocInViewport()})}function initFootnoteRefPopover(){getFootnoteRefs().each(function(b,f){var d=$(f);var a=$(document.getElementById(d.attr("href").substring(1)));var c=$(a.children()[getFootnoteHlIndex()]);d.popover({trigger:"hover",placement:"auto top",html:true,container:"body",content:c.html()});d.on("hide.bs.popover",function(){if(window.gFootnotePopoverLink){return false}return true});d.mouseleave(function(){});d.mouseenter(function(){var i=$(this);if(window.gFootnotePopoverLink&&window.gFootnotePopoverLink[0]!=i[0]){hideFootnotePopover()}var g=$(".popover")[0];if(g){window.gEnableMouseXYRecord=true;window.gFootnotePopoverLink=i;var h=g.getBoundingClientRect();var e=f.getBoundingClientRect();window.gPopoverXY={};window.gPopoverXY.top=h.top<e.top?h.top:e.bottom;window.gPopoverXY.bottom=h.top<e.top?e.top:h.bottom;window.gPopoverXY.left=h.left<e.left?h.left:e.left;window.gPopoverXY.right=h.right<e.right?e.right:h.right;window.gRefLinkXY={};window.gRefLinkXY.top=e.top;window.gRefLinkXY.bottom=e.bottom;window.gRefLinkXY.left=e.left-10;window.gRefLinkXY.right=e.right+10}})})}function hideFootnotePopover(){var a=window.gFootnotePopoverLink;window.gFootnotePopoverLink=null;window.gEnableFootnotePopover=false;a.popover("hide")}function isPositionInRect(a,c,b){if(a>=b.left&&a<=b.right&&c>=b.top&&c<=b.bottom){return true}return false}function initMouseXYRecord(){$(document).mousemove(function(b){window.gMousePositionX=b.clientX;window.gMousePositionY=b.clientY;if(window.gEnableMouseXYRecord&&window.gPopoverXY&&window.gRefLinkXY){if(!isPositionInRect(b.clientX,b.clientY,window.gPopoverXY)&&!isPositionInRect(b.clientX,b.clientY,window.gRefLinkXY)){window.gEnableMouseXYRecord=false;hideFootnotePopover()}}if(isPositionInRect(b.clientX,b.clientY,getTocList()[0].getBoundingClientRect())){window.gMouseInSidebarTocList=true}else{window.gMouseInSidebarTocList=false}var c=getMainContent().getBoundingClientRect();if(getToolbar()&&b.clientY>c.bottom-c.height){if(!window.gToolbarAnimationEnabled){return}var a=function(){$(getToolbar()).animate({left:window.gToolbarLeftPos},500,complete=function(){window.gToolbarAnimationEnabled=true;window.gToolbarHidden=true})};if(window.gToolbarHidden&&b.clientX<c.left){window.gToolbarAnimationEnabled=false;$(getToolbar()).animate({left:"0px"},500,complete=function(){window.gToolbarAnimationEnabled=true;window.gToolbarHidden=false;if(window.gMousePositionX>c.left){a()}})}else{if(!window.gToolbarHidden&&b.clientX>c.left){window.gToolbarAnimationEnabled=false;a()}}}})}function initScrollAnimation(a,b,c,d){a.each(function(f,g){$(g).click(function(i){i.preventDefault();var e=$(g).attr("href");var h=e.substring(e.indexOf("#")+1);if(window.location.hash!=h&&window.history.pushState){window.history.pushState("toc change",h,"#"+h)}window.gEnableTocStatusUpdate=false;target=$(document.getElementById(h));source=$(this);$("body, html").animate({scrollTop:b(target,source)},c,function(){d(source)})})})}function showToc(a){a.each(function(b,c){var d=$(c);if(d.is("li")){d.attr("style","display:list-item;")}else{if(d.is("ol")||d.is("ul")){d.attr("style","display:block;")}}})}function hideToc(a){a.each(function(b,c){$(c).attr("style","display:none;")})}function initAllTocsCtrl(){if(isAllTocsClosed()){closeAllTocs()}else{openAllTocs()}getSidebarTocCtrl().click(function(){toggleAllTocs()})}function toggleAllTocs(){if(isAllTocsClosed()){getSidebarToc().data("status","open");getSidebarTocCtrl().attr("class","icon-close-tocs");openAllTocs()}else{getSidebarToc().data("status","closed");getSidebarTocCtrl().attr("class","icon-open-tocs");closeAllTocs()}locateTocInViewport()}function isAllTocsClosed(){if("closed"==getSidebarToc().data("status")){return true}return false}function getSidebarTocCtrl(){if(!window.gSidebarTocCtrl){window.gSidebarTocCtrl=$("#niu2-sidebar-toc-ctrl")}return window.gSidebarTocCtrl};